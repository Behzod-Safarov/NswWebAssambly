@page "/nsw_soilsensor"
@inject IJSRuntime JSRuntime
@inherits LayoutComponentBase
<NSWLayout />
<br>
<br>

<div class="container mt-5">
    <h1 class="display-4 text-center">NSW tuproq namlik sensori</h1>
    <p class="lead text-center">Tuproq namligini samarali monitoring qilish uchun NSW sensoridan foydalaning</p>

    <div class="my-5">
        <h2>Umumiy ma‚Äôlumot</h2>
        <p>NSW tuproq namlik sensori tuproqning namlik darajasini o‚Äòlchash uchun mo‚Äòljallangan sig'im sensor bo‚Äòlib, qishloq xo‚Äòjaligi va aqlli bog‚Äòdorchilik loyihalari uchun ideal. Sensor qora rangga ega bo‚Äòlib, NSW boshqaruv platasining qora (analog) portlariga ulanadi. U tuproqdagi suv miqdorini sig'im o‚Äòlchash orqali aniqlaydi, bu esa korroziyaga chidamlilik va uzoq muddatli ishonchlilikni ta‚Äôminlaydi. Sensor tuproq namligiga qarab analog signal (0‚Äì3.3V yoki 0‚Äì5V) chiqaradi, bu signal Arduino yoki boshqa mikrokontroller yordamida o‚Äòqiladi.</p>
        <div class="image-container">
            <img src="Images/soil.jpg" alt="NSW tuproq namlik sensori" class="img-fluid rounded shadow my-3" style="max-width: 150px;" loading="lazy">
            <p class="image-caption">NSW tuproq namlik sensori ‚Äì aqlli sug‚Äòorish uchun</p>
        </div>
    </div>

    <div class="my-5">
        <h2>Asosiy xususiyatlar</h2>
        <ul>
            <li>Ishlash kuchlanishi: 3.3V‚Äì5V DC</li>
            <li>Chiqish signali: Analog (0‚ÄìVCC, namlikka teskari proportsional)</li>
            <li>Sensor turi: sig'im, korroziyaga chidamli</li>
            <li>O‚Äòlchash diapazoni: 0‚Äì1023 (Arduino analog o‚Äòqishi)</li>
            <li>Modul hajmi: 98√ó23√ó4 mm</li>
            <li>Ulanish: PH2.54-3P yoki Dupont simlari</li>
            <li>Energiya sarfi: ~5 mA</li>
        </ul>
        <p>Eslatma: Sensorning elektronik qismini tuproq yoki suvga botirmang, faqat zond qismi tuproqqa joylashtiriladi. Kalibrlash tuproq turi va sharoitlariga qarab zarur bo‚Äòlishi mumkin.</p>
    </div>

    <div class="my-5">
        <h2>Ilovalar</h2>
        <p>NSW tuproq namlik sensori quyidagi loyihalarda qo‚Äòllaniladi:</p>
        <ul>
            <li>Avtomatik sug‚Äòorish tizimlari</li>
            <li>Qishloq xo‚Äòjaligi va issiqxona monitoringi</li>
            <li>Ta‚Äôlim loyihalari</li>
            <li>Uy o‚Äòsimliklarini avtomatlashtirilgan parvarish qilish</li>
            <li>IoT asosidagi tuproq monitoringi</li>
        </ul>
    </div>

    <div class="my-5">
        <h2>Pin ta‚Äôrifi</h2>
        <p>NSW tuproq namlik sensori quyidagi pinlarga ega:</p>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Pin</th>
                    <th>Vazifasi</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>GND</td>
                    <td>Manfiy quvvat </td>
                </tr>
                <tr>
                    <td>VCC</td>
                    <td>Quvvat manbai (3.3V yoki 5V)</td>
                </tr>
                <tr>
                    <td>AOUT</td>
                    <td>Analog signal chiqishi</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="my-5">
        <h2>Simlarni ulash rejimi</h2>
        <p>‚óè RJ25 bilan ulanish</p>
        <p>Sensor qora rangga ega bo‚Äòlib, RJ25 porti orqali NSW boshqaruv platasining qora rangli portlariga (masalan, ‚Ññ6, ‚Ññ7 yoki ‚Ññ8) ulanadi.</p>
        @* <div class="image-container">
            <img src="Images/soilsensor_rj25.jpg" alt="Tuproq namlik sensori RJ25 ulanishi" class="img-fluid rounded shadow my-3" style="max-width: 400px;" loading="lazy">
            <p class="image-caption">RJ25 porti orqali ulanish sxemasi</p>
        </div> *@
@* 
        <p>‚óè Dupont simi bilan ulanish</p>
        <p>Dupont simi yordamida modulni Arduino UNO platasiga ulashda quyidagi pinlardan foydalaniladi:</p>
        <ul>
            <li><b>VCC</b> ‚Üí Arduino 5V</li>
            <li><b>GND</b> ‚Üí Arduino GND</li>
            <li><b>AOUT</b> ‚Üí Arduino A0 (yoki boshqa analog pin)</li>
        </ul>
        <div class="image-container">
            <img src="Images/soilsensor_dupont.jpg" alt="Tuproq namlik sensori Dupont ulanishi" class="img-fluid rounded shadow my-3" style="max-width: 400px;" loading="lazy">
            <p class="image-caption">Dupont simi orqali ulanish sxemasi</p>
        </div> *@
    </div>

    <div class="my-5">
        <h2>Dasturlash bo‚Äòyicha qo‚Äòllanma</h2>
        <p>Arduino IDE yordamida NSW tuproq namlik sensorini boshqarish uchun maxsus kutubxona talab qilinmaydi ammo <code>NswSoilSensor.h</code> kutubxonasi orqali soddaroq kod yozish mumkin. Quyidagi kod analog chiqish orqali tuproq namligini o‚Äòqib, foiz sifatida Serial monitorda ko‚Äòrsatadi.</p>
        
        <div class="code-container">
            <div class="code-header">
                <span>Arduino dastur namunasi</span>
                <button class="copy-btn" onclick="copyCode(this)" title="Nusxa olish">Nusxa olish</button>
            </div>
            <pre class="line-numbers"><code class="language-cpp">
#include &lt;NswPort.h>
#include &lt;NswSoilSensor.h>

// üìå Tuproq namligi sensori PORT_2 ga ulangan (A0, A1)
NswSoilSensor tuproqSensor(PORT_2);

void setup() {
    Serial.begin(9600); // üìå Serial monitorni ishga tushirish
}

void loop() {
    int analogQiymat = tuproqSensor.readRaw(); // üìå Analog qiymatni o'qish (0-1023)
    int namlikFoiz = tuproqSensor.readPercentage(); // üìå Namlik foizda (0-100%)

    Serial.print("Analog qiymat: ");
    Serial.print(analogQiymat);
    Serial.print(" | Namlik: ");
    Serial.print(namlikFoiz);
    Serial.println("%");

    delay(1000); // ‚è≥ 1 soniya kutish
}

            </code></pre>
        </div>

        @* <p>Eslatma: <code>dryValue</code> va <code>wetValue</code> qiymatlari tuproq turi va sharoitlariga qarab kalibrlanishi kerak. Bu qiymatlarni aniqlash uchun quruq va nam tuproqda sinov o‚Äòtkazing.</p> *@
        
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-coy.min.css" rel="stylesheet" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    </div>

    <div class="my-5">
        <h2>Umumiy tahlil</h2>
        <p>NSW tuproq namlik sensori sig'im texnologiyaga asoslanadi, bu tuproqdagi suv miqdorini dielektrik o‚Äòtkazuvchanlik orqali aniqlaydi. Sensorning korroziyaga chidamliligi va soddaligi uni aqlli sug‚Äòorish, qishloq xo‚Äòjaligi va ta‚Äôlim loyihalari uchun ideal qiladi. Analog chiqish tuproq namligiga teskari proportsional bo‚Äòlib, namlik ko‚Äòp bo‚Äòlganda signal qiymati pasayadi.</p>
    </div>

    <div class="text-center my-5">
        <a class="btn btn-lg custom-btn shadow-lg mx-2" href="/nsw_touchsensor" role="button">
            <i class="fas fa-arrow-left"></i> Oldingi
        </a>
        <a class="btn btn-lg custom-btn shadow-lg mx-2" href="/nsw_4button" role="button">
            Keyingi <i class="fas fa-arrow-right"></i>
        </a>
    </div>
</div>

<style>
.custom-btn {
    background: linear-gradient(135deg, rgb(0, 217, 255), rgb(0, 150, 200));
    color: white;
    padding: 12px 24px;
    font-size: 18px;
    font-weight: bold;
    border: none;
    border-radius: 50px;
    transition: all 0.3s ease-in-out;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
}

.custom-btn:hover {
    background: linear-gradient(135deg, rgb(0, 150, 200), rgb(0, 217, 255));
    transform: scale(1.05);
    box-shadow: 0px 5px 15px rgba(0, 217, 255, 0.4);
}

.custom-btn i {
    margin: 0 8px;
}

.code-container {
    position: relative;
    background: linear-gradient(135deg, #f5f7fa 0%, #e4e7eb 100%);
    border-radius: 12px;
    margin: 2rem 0;
    padding: 0;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    border: 2px solid #007bff;
    transition: transform 0.3s ease;
}

.code-container:hover {
    transform: translateY(-5px);
}

.code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, #007bff, #0056b3);
    padding: 12px 20px;
    border-bottom: 1px solid #004085;
    color: #fff;
    font-size: 16px;
    font-weight: bold;
}

.copy-btn {
    background: #28a745;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
    position: relative;
}

.copy-btn:hover {
    background: #218838;
    transform: scale(1.05);
}

.copy-btn.copied {
    background: #17a2b8;
}

.copy-btn.copied::after {
    content: "Nusxa olindi!";
    position: absolute;
    top: -30px;
    right: 0;
    background: #17a2b8;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    opacity: 0;
    animation: fadeInOut 1.5s ease;
}

@@keyframes fadeInOut {
    0% { opacity: 0; transform: translateY(10px); }
    20% { opacity: 1; transform: translateY(0); }
    80% { opacity: 1; transform: translateY(0); }
    100% { opacity: 0; transform: translateY(-10px); }
}

pre.line-numbers {
    margin: 0;
    padding: 20px;
    overflow-x: auto;
    background: #fff;
    border-radius: 0 0 12px 12px;
}

code {
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 15px;
}

.prism-coy .line-numbers-rows {
    border-right: 1px solid #ddd;
    padding-right: 10px;
    margin-right: 10px;
}

.image-container {
    text-align: center;
    margin: 1.5rem 0;
}

.img-fluid {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: 2px solid transparent;
    background: linear-gradient(135deg, #007bff, #00d4ff) border-box;
    border-radius: 10px;
}

.img-fluid:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 20px rgba(0, 123, 255, 0.3);
}

.image-caption {
    font-size: 14px;
    color: #555;
    margin-top: 10px;
    font-style: italic;
}
</style>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await JSRuntime.InvokeVoidAsync("scrollToTop");
    }
}

<script>
    window.scrollToTop = function () {
        window.scrollTo(0, 0);
    };

    function copyCode(button) {
        const code = button.parentElement.nextElementSibling.querySelector('code').textContent;
        navigator.clipboard.writeText(code).then(() => {
            button.classList.add('copied');
            button.textContent = 'Nusxa olindi!';
            setTimeout(() => {
                button.classList.remove('copied');
                button.textContent = 'Nusxa olish';
            }, 2000);
        });
    }
</script>